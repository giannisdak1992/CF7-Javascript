<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>XHR Get</title>
  </head>
  <body>
    <h1>XMLHttpRequest GET Request</h1>
    <button type="button" onclick="fetchOneObj()">Fetch One Object</button>
    <p id="responseText"></p>
    <script>
      function fetchOneObj() {
        const xhr = new XMLHttpRequest()

        xhr.open('GET', 'https://jsonplaceholder.typicode.com/posts/1', true) // 1. initialize API

        xhr.onreadystatechange = function () {
          // 3. Validation
          if (xhr.status === 4) {
            if (xhr.status >= 200 && xhr.status < 300) {
              handleResponse(JSON.parse(xhr.responseText)) //4. Parse JSON
            } else {
              showError(xhr.statusText)
            }
          }
        }

        xhr.send() //2. API CALL
      }

      function handleResponse(response) {
        // 5. render
        document.getElementById(
          'responseText'
        ).innerHTML = `<b>Title</b>: ${response.title}
                            <br> <b>Body</b>: ${response.body}`
      }

      function showError(statusText) {
        document.getElementById('responseText')
      }
    </script>
  </body>
</html>
